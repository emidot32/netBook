"use strict";
const aws = require("aws-sdk");
const AWS = require("aws-sdk-mock");
const nodeunit = require("nodeunit");
const vpcs_1 = require("../../lib/context-providers/vpcs");
AWS.setSDKInstance(aws);
const mockSDK = {
    defaultAccount: () => Promise.resolve('123456789012'),
    defaultRegion: () => Promise.resolve('bermuda-triangle-1337'),
    cloudFormation: () => { throw new Error('Not Mocked'); },
    ec2: () => Promise.resolve(new aws.EC2()),
    ecr: () => { throw new Error('Not Mocked'); },
    route53: () => { throw new Error('Not Mocked'); },
    s3: () => { throw new Error('Not Mocked'); },
    ssm: () => { throw new Error('Not Mocked'); },
};
function mockVpcLookup(test, options) {
    const VpcId = 'vpc-1234567';
    AWS.mock('EC2', 'describeVpcs', (params, cb) => {
        test.deepEqual(params.Filters, [{ Name: 'foo', Values: ['bar'] }]);
        return cb(null, { Vpcs: [{ VpcId }] });
    });
    AWS.mock('EC2', 'describeSubnets', (params, cb) => {
        test.deepEqual(params.Filters, [{ Name: 'vpc-id', Values: [VpcId] }]);
        return cb(null, { Subnets: options.subnets });
    });
    AWS.mock('EC2', 'describeRouteTables', (params, cb) => {
        test.deepEqual(params.Filters, [{ Name: 'vpc-id', Values: [VpcId] }]);
        return cb(null, { RouteTables: options.routeTables });
    });
    AWS.mock('EC2', 'describeVpnGateways', (params, cb) => {
        test.deepEqual(params.Filters, [
            { Name: 'attachment.vpc-id', Values: [VpcId] },
            { Name: 'attachment.state', Values: ['attached'] },
            { Name: 'state', Values: ['available'] }
        ]);
        return cb(null, { VpnGateways: options.vpnGateways });
    });
}
module.exports = nodeunit.testCase({
    async 'looks up the requested (symmetric) VPC'(test) {
        mockVpcLookup(test, {
            subnets: [
                { SubnetId: 'sub-123456', AvailabilityZone: 'bermuda-triangle-1337', MapPublicIpOnLaunch: true },
                { SubnetId: 'sub-789012', AvailabilityZone: 'bermuda-triangle-1337', MapPublicIpOnLaunch: false }
            ],
            routeTables: [
                { Associations: [{ SubnetId: 'sub-123456' }], RouteTableId: 'rtb-123456', },
                { Associations: [{ SubnetId: 'sub-789012' }], RouteTableId: 'rtb-789012', }
            ],
            vpnGateways: [{ VpnGatewayId: 'gw-abcdef' }]
        });
        const result = await new vpcs_1.VpcNetworkContextProviderPlugin(mockSDK).getValue({
            filter: { foo: 'bar' },
            returnAsymmetricSubnets: true,
        });
        test.deepEqual(result, {
            availabilityZones: [],
            isolatedSubnetIds: undefined,
            isolatedSubnetNames: undefined,
            isolatedSubnetRouteTableIds: undefined,
            privateSubnetIds: undefined,
            privateSubnetNames: undefined,
            privateSubnetRouteTableIds: undefined,
            publicSubnetIds: undefined,
            publicSubnetNames: undefined,
            publicSubnetRouteTableIds: undefined,
            subnetGroups: [
                {
                    name: 'Public',
                    type: 'Public',
                    subnets: [
                        {
                            subnetId: 'sub-123456',
                            availabilityZone: 'bermuda-triangle-1337',
                            routeTableId: 'rtb-123456',
                        },
                    ],
                },
                {
                    name: 'Private',
                    type: 'Private',
                    subnets: [
                        {
                            subnetId: 'sub-789012',
                            availabilityZone: 'bermuda-triangle-1337',
                            routeTableId: 'rtb-789012',
                        },
                    ],
                },
            ],
            vpcId: 'vpc-1234567',
            vpnGatewayId: 'gw-abcdef'
        });
        AWS.restore();
        test.done();
    },
    async 'throws when no such VPC is found'(test) {
        AWS.mock('EC2', 'describeVpcs', (params, cb) => {
            test.deepEqual(params.Filters, [{ Name: 'foo', Values: ['bar'] }]);
            return cb(null, {});
        });
        try {
            await new vpcs_1.VpcNetworkContextProviderPlugin(mockSDK).getValue({
                filter: { foo: 'bar' },
                returnAsymmetricSubnets: true,
            });
            throw Error('The expected exception was not raised!');
        }
        catch (e) {
            test.throws(() => { throw e; }, /Could not find any VPCs matching/);
        }
        AWS.restore();
        test.done();
    },
    async 'throws when multiple VPCs are found'(test) {
        // GIVEN
        AWS.mock('EC2', 'describeVpcs', (params, cb) => {
            test.deepEqual(params.Filters, [{ Name: 'foo', Values: ['bar'] }]);
            return cb(null, { Vpcs: [{ VpcId: 'vpc-1' }, { VpcId: 'vpc-2' }] });
        });
        // WHEN
        try {
            await new vpcs_1.VpcNetworkContextProviderPlugin(mockSDK).getValue({
                filter: { foo: 'bar' },
                returnAsymmetricSubnets: true,
            });
            throw Error('The expected exception was not raised!');
        }
        catch (e) {
            test.throws(() => { throw e; }, /Found 2 VPCs matching/);
        }
        AWS.restore();
        test.done();
    },
    async 'uses the VPC main route table when a subnet has no specific association'(test) {
        mockVpcLookup(test, {
            subnets: [
                { SubnetId: 'sub-123456', AvailabilityZone: 'bermuda-triangle-1337', MapPublicIpOnLaunch: true },
                { SubnetId: 'sub-789012', AvailabilityZone: 'bermuda-triangle-1337', MapPublicIpOnLaunch: false }
            ],
            routeTables: [
                { Associations: [{ SubnetId: 'sub-123456' }], RouteTableId: 'rtb-123456', },
                { Associations: [{ Main: true }], RouteTableId: 'rtb-789012', }
            ],
            vpnGateways: [{ VpnGatewayId: 'gw-abcdef' }]
        });
        const result = await new vpcs_1.VpcNetworkContextProviderPlugin(mockSDK).getValue({
            filter: { foo: 'bar' },
            returnAsymmetricSubnets: true,
        });
        test.deepEqual(result, {
            availabilityZones: [],
            isolatedSubnetIds: undefined,
            isolatedSubnetNames: undefined,
            isolatedSubnetRouteTableIds: undefined,
            privateSubnetIds: undefined,
            privateSubnetNames: undefined,
            privateSubnetRouteTableIds: undefined,
            publicSubnetIds: undefined,
            publicSubnetNames: undefined,
            publicSubnetRouteTableIds: undefined,
            subnetGroups: [
                {
                    name: 'Public',
                    type: 'Public',
                    subnets: [
                        {
                            subnetId: 'sub-123456',
                            availabilityZone: 'bermuda-triangle-1337',
                            routeTableId: 'rtb-123456',
                        },
                    ],
                },
                {
                    name: 'Private',
                    type: 'Private',
                    subnets: [
                        {
                            subnetId: 'sub-789012',
                            availabilityZone: 'bermuda-triangle-1337',
                            routeTableId: 'rtb-789012',
                        },
                    ],
                },
            ],
            vpcId: 'vpc-1234567',
            vpnGatewayId: 'gw-abcdef'
        });
        test.done();
        AWS.restore();
    },
    async 'Recognize public subnet by route table'(test) {
        // GIVEN
        mockVpcLookup(test, {
            subnets: [
                { SubnetId: 'sub-123456', AvailabilityZone: 'bermuda-triangle-1337', MapPublicIpOnLaunch: false },
            ],
            routeTables: [
                {
                    Associations: [{ SubnetId: 'sub-123456' }],
                    RouteTableId: 'rtb-123456',
                    Routes: [
                        {
                            DestinationCidrBlock: "10.0.2.0/26",
                            Origin: "CreateRoute",
                            State: "active",
                            VpcPeeringConnectionId: "pcx-xxxxxx"
                        },
                        {
                            DestinationCidrBlock: "10.0.1.0/24",
                            GatewayId: "local",
                            Origin: "CreateRouteTable",
                            State: "active"
                        },
                        {
                            DestinationCidrBlock: "0.0.0.0/0",
                            GatewayId: "igw-xxxxxx",
                            Origin: "CreateRoute",
                            State: "active"
                        }
                    ],
                },
            ],
        });
        // WHEN
        const result = await new vpcs_1.VpcNetworkContextProviderPlugin(mockSDK).getValue({
            filter: { foo: 'bar' },
            returnAsymmetricSubnets: true,
        });
        // THEN
        test.deepEqual(result, {
            availabilityZones: [],
            isolatedSubnetIds: undefined,
            isolatedSubnetNames: undefined,
            isolatedSubnetRouteTableIds: undefined,
            privateSubnetIds: undefined,
            privateSubnetNames: undefined,
            privateSubnetRouteTableIds: undefined,
            publicSubnetIds: undefined,
            publicSubnetNames: undefined,
            publicSubnetRouteTableIds: undefined,
            subnetGroups: [
                {
                    name: 'Public',
                    type: 'Public',
                    subnets: [
                        {
                            subnetId: 'sub-123456',
                            availabilityZone: 'bermuda-triangle-1337',
                            routeTableId: 'rtb-123456',
                        },
                    ],
                },
            ],
            vpcId: 'vpc-1234567',
            vpnGatewayId: undefined,
        });
        AWS.restore();
        test.done();
    },
    async 'works for asymmetric subnets (not spanning the same Availability Zones)'(test) {
        // GIVEN
        mockVpcLookup(test, {
            subnets: [
                { SubnetId: 'pri-sub-in-1b', AvailabilityZone: 'us-west-1b', MapPublicIpOnLaunch: false },
                { SubnetId: 'pub-sub-in-1c', AvailabilityZone: 'us-west-1c', MapPublicIpOnLaunch: true },
                { SubnetId: 'pub-sub-in-1b', AvailabilityZone: 'us-west-1b', MapPublicIpOnLaunch: true },
                { SubnetId: 'pub-sub-in-1a', AvailabilityZone: 'us-west-1a', MapPublicIpOnLaunch: true },
            ],
            routeTables: [
                { Associations: [{ Main: true }], RouteTableId: 'rtb-123' },
            ],
        });
        // WHEN
        const result = await new vpcs_1.VpcNetworkContextProviderPlugin(mockSDK).getValue({
            filter: { foo: 'bar' },
            returnAsymmetricSubnets: true,
        });
        // THEN
        test.deepEqual(result, {
            availabilityZones: [],
            isolatedSubnetIds: undefined,
            isolatedSubnetNames: undefined,
            isolatedSubnetRouteTableIds: undefined,
            privateSubnetIds: undefined,
            privateSubnetNames: undefined,
            privateSubnetRouteTableIds: undefined,
            publicSubnetIds: undefined,
            publicSubnetNames: undefined,
            publicSubnetRouteTableIds: undefined,
            subnetGroups: [
                {
                    name: 'Private',
                    type: 'Private',
                    subnets: [
                        {
                            subnetId: 'pri-sub-in-1b',
                            availabilityZone: 'us-west-1b',
                            routeTableId: 'rtb-123',
                        },
                    ],
                },
                {
                    name: 'Public',
                    type: 'Public',
                    subnets: [
                        {
                            subnetId: 'pub-sub-in-1a',
                            availabilityZone: 'us-west-1a',
                            routeTableId: 'rtb-123',
                        },
                        {
                            subnetId: 'pub-sub-in-1b',
                            availabilityZone: 'us-west-1b',
                            routeTableId: 'rtb-123',
                        },
                        {
                            subnetId: 'pub-sub-in-1c',
                            availabilityZone: 'us-west-1c',
                            routeTableId: 'rtb-123',
                        },
                    ],
                },
            ],
            vpcId: 'vpc-1234567',
            vpnGatewayId: undefined,
        });
        AWS.restore();
        test.done();
    },
    async 'allows specifying the subnet group name tag'(test) {
        // GIVEN
        mockVpcLookup(test, {
            subnets: [
                {
                    SubnetId: 'pri-sub-in-1b', AvailabilityZone: 'us-west-1b', MapPublicIpOnLaunch: false, Tags: [
                        { Key: 'Tier', Value: 'restricted' },
                    ]
                },
                {
                    SubnetId: 'pub-sub-in-1c', AvailabilityZone: 'us-west-1c', MapPublicIpOnLaunch: true, Tags: [
                        { Key: 'Tier', Value: 'connectivity' },
                    ]
                },
                {
                    SubnetId: 'pub-sub-in-1b', AvailabilityZone: 'us-west-1b', MapPublicIpOnLaunch: true, Tags: [
                        { Key: 'Tier', Value: 'connectivity' },
                    ]
                },
                {
                    SubnetId: 'pub-sub-in-1a', AvailabilityZone: 'us-west-1a', MapPublicIpOnLaunch: true, Tags: [
                        { Key: 'Tier', Value: 'connectivity' },
                    ]
                },
            ],
            routeTables: [
                { Associations: [{ Main: true }], RouteTableId: 'rtb-123' },
            ],
        });
        const result = await new vpcs_1.VpcNetworkContextProviderPlugin(mockSDK).getValue({
            filter: { foo: 'bar' },
            returnAsymmetricSubnets: true,
            subnetGroupNameTag: 'Tier',
        });
        test.deepEqual(result, {
            availabilityZones: [],
            isolatedSubnetIds: undefined,
            isolatedSubnetNames: undefined,
            isolatedSubnetRouteTableIds: undefined,
            privateSubnetIds: undefined,
            privateSubnetNames: undefined,
            privateSubnetRouteTableIds: undefined,
            publicSubnetIds: undefined,
            publicSubnetNames: undefined,
            publicSubnetRouteTableIds: undefined,
            subnetGroups: [
                {
                    name: 'restricted',
                    type: 'Private',
                    subnets: [
                        {
                            subnetId: 'pri-sub-in-1b',
                            availabilityZone: 'us-west-1b',
                            routeTableId: 'rtb-123',
                        },
                    ],
                },
                {
                    name: 'connectivity',
                    type: 'Public',
                    subnets: [
                        {
                            subnetId: 'pub-sub-in-1a',
                            availabilityZone: 'us-west-1a',
                            routeTableId: 'rtb-123',
                        },
                        {
                            subnetId: 'pub-sub-in-1b',
                            availabilityZone: 'us-west-1b',
                            routeTableId: 'rtb-123',
                        },
                        {
                            subnetId: 'pub-sub-in-1c',
                            availabilityZone: 'us-west-1c',
                            routeTableId: 'rtb-123',
                        },
                    ],
                },
            ],
            vpcId: 'vpc-1234567',
            vpnGatewayId: undefined,
        });
        AWS.restore();
        test.done();
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGVzdC5hc3ltbWV0cmljLXZwY3MuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJ0ZXN0LmFzeW1tZXRyaWMtdnBjcy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsK0JBQWdDO0FBQ2hDLG9DQUFxQztBQUNyQyxxQ0FBc0M7QUFFdEMsMkRBQW1GO0FBRW5GLEdBQUcsQ0FBQyxjQUFjLENBQUMsR0FBRyxDQUFDLENBQUM7QUFFeEIsTUFBTSxPQUFPLEdBQVM7SUFDcEIsY0FBYyxFQUFFLEdBQUcsRUFBRSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsY0FBYyxDQUFDO0lBQ3JELGFBQWEsRUFBRSxHQUFHLEVBQUUsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLHVCQUF1QixDQUFDO0lBQzdELGNBQWMsRUFBRSxHQUFHLEVBQUUsR0FBRyxNQUFNLElBQUksS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUN4RCxHQUFHLEVBQUUsR0FBRyxFQUFFLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxJQUFJLEdBQUcsQ0FBQyxHQUFHLEVBQUUsQ0FBQztJQUN6QyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsTUFBTSxJQUFJLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDN0MsT0FBTyxFQUFFLEdBQUcsRUFBRSxHQUFHLE1BQU0sSUFBSSxLQUFLLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ2pELEVBQUUsRUFBRSxHQUFHLEVBQUUsR0FBRyxNQUFNLElBQUksS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUM1QyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsTUFBTSxJQUFJLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUM7Q0FDOUMsQ0FBQztBQTJaRixTQUFTLGFBQWEsQ0FBQyxJQUFtQixFQUFFLE9BQXlCO0lBQ25FLE1BQU0sS0FBSyxHQUFHLGFBQWEsQ0FB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LEVBQUUsUUFBUTtvQkFDZCxPQUFPLEVBQUU7d0JBQ1A7NEJBQ0UsUUFBUSxFQUFFLGVBQWU7NEJBQ3pCLGdCQUFnQixFQUFFLFlBQVk7NEJBQzlCLFlBQVksRUFBRSxTQUFTO3lCQUN4Qjt3QkFDRDs0QkFDRSxRQUFRLEVBQUUsZUFBZTs0QkFDekIsZ0JBQWdCLEVBQUUsWUFBWTs0QkFDOUIsWUFBWSxFQUFFLFNBQVM7eUJBQ3hCO3dCQUNEOzRCQUNFLFFBQVEsRUFBRSxlQUFlOzRCQUN6QixnQkFBZ0IsRUFBRSxZQUFZOzRCQUM5QixZQUFZLEVBQUUsU0FBUzt5QkFDeEI7cUJBQ0Y7aUJBQ0Y7YUFDRjtZQUNELEtBQUssRUFBRSxhQUFhO1lBQ3BCLFlBQVksRUFBRSxTQUFTO1NBQ3hCLENBQUMsQ0FBQztRQUVILEdBQUcsQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUNkLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUNkLENBQUM7Q0FDRixDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgYXdzID0gcmVxdWlyZSgnYXdzLXNkaycpO1xuaW1wb3J0IEFXUyA9IHJlcXVpcmUoJ2F3cy1zZGstbW9jaycpO1xuaW1wb3J0IG5vZGV1bml0ID0gcmVxdWlyZSgnbm9kZXVuaXQnKTtcbmltcG9ydCB7IElTREsgfSBmcm9tICcuLi8uLi9saWIvYXBpJztcbmltcG9ydCB7IFZwY05ldHdvcmtDb250ZXh0UHJvdmlkZXJQbHVnaW4gfSBmcm9tICcuLi8uLi9saWIvY29udGV4dC1wcm92aWRlcnMvdnBjcyc7XG5cbkFXUy5zZXRTREtJbnN0YW5jZShhd3MpO1xuXG5jb25zdCBtb2NrU0RLOiBJU0RLID0ge1xuICBkZWZhdWx0QWNjb3VudDogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKCcxMjM0NTY3ODkwMTInKSxcbiAgZGVmYXVsdFJlZ2lvbjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKCdiZXJtdWRhLXRyaWFuZ2xlLTEzMzcnKSxcbiAgY2xvdWRGb3JtYXRpb246ICgpID0+IHsgdGhyb3cgbmV3IEVycm9yKCdOb3QgTW9ja2VkJyk7IH0sXG4gIGVjMjogKCkgPT4gUHJvbWlzZS5yZXNvbHZlKG5ldyBhd3MuRUMyKCkpLFxuICBlY3I6ICgpID0+IHsgdGhyb3cgbmV3IEVycm9yKCdOb3QgTW9ja2VkJyk7IH0sXG4gIHJvdXRlNTM6ICgpID0+IHsgdGhyb3cgbmV3IEVycm9yKCdOb3QgTW9ja2VkJyk7IH0sXG4gIHMzOiAoKSA9PiB7IHRocm93IG5ldyBFcnJvcignTm90IE1vY2tlZCcpOyB9LFxuICBzc206ICgpID0+IHsgdGhyb3cgbmV3IEVycm9yKCdOb3QgTW9ja2VkJyk7IH0sXG59O1xuXG50eXBlIEF3c0NhbGxiYWNrPFQ+ID0gKGVycjogRXJyb3IgfCBudWxsLCB2YWw6IFQpID0+IHZvaWQ7XG5cbmV4cG9ydCA9IG5vZGV1bml0LnRlc3RDYXNlKHtcbiAgYXN5bmMgJ2xvb2tzIHVwIHRoZSByZXF1ZXN0ZWQgKHN5bW1ldHJpYykgVlBDJyh0ZXN0OiBub2RldW5pdC5UZXN0KSB7XG4gICAgbW9ja1ZwY0xvb2t1cCh0ZXN0LCB7XG4gICAgICBzdWJuZXRzOiBbXG4gICAgICAgIHsgU3VibmV0SWQ6ICdzdWItMTIzNDU2JywgQXZhaWxhYmlsaXR5Wm9uZTogJ2Jlcm11ZGEtdHJpYW5nbGUtMTMzNycsIE1hcFB1YmxpY0lwT25MYXVuY2g6IHRydWUgfSxcbiAgICAgICAgeyBTdWJuZXRJZDogJ3N1Yi03ODkwMTInLCBBdmFpbGFiaWxpdHlab25lOiAnYmVybXVkYS10cmlhbmdsZS0xMzM3JywgTWFwUHVibGljSXBPbkxhdW5jaDogZmFsc2UgfVxuICAgICAgXSxcbiAgICAgIHJvdXRlVGFibGVzOiBbXG4gICAgICAgIHsgQXNzb2NpYXRpb25zOiBbeyBTdWJuZXRJZDogJ3N1Yi0xMjM0NTYnIH1dLCBSb3V0ZVRhYmxlSWQ6ICdydGItMTIzNDU2JywgfSxcbiAgICAgICAgeyBBc3NvY2lhdGlvbnM6IFt7IFN1Ym5ldElkOiAnc3ViLTc4OTAxMicgfV0sIFJvdXRlVGFibGVJZDogJ3J0Yi03ODkwMTInLCB9XG4gICAgICBdLFxuICAgICAgdnBuR2F0ZXdheXM6IFt7IFZwbkdhdGV3YXlJZDogJ2d3LWFiY2RlZicgfV1cblxuICAgIH0pO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbmV3IFZwY05ldHdvcmtDb250ZXh0UHJvdmlkZXJQbHVnaW4obW9ja1NESykuZ2V0VmFsdWUoe1xuICAgICAgZmlsdGVyOiB7IGZvbzogJ2JhcicgfSxcbiAgICAgIHJldHVybkFzeW1tZXRyaWNTdWJuZXRzOiB0cnVlLFxuICAgIH0pO1xuXG4gICAgdGVzdC5kZWVwRXF1YWwocmVzdWx0LCB7XG4gICAgICBhdmFpbGFiaWxpdHlab25lczogW10sXG4gICAgICBpc29sYXRlZFN1Ym5ldElkczogdW5kZWZpbmVkLFxuICAgICAgaXNvbGF0ZWRTdWJuZXROYW1lczogdW5kZWZpbmVkLFxuICAgICAgaXNvbGF0ZWRTdWJuZXRSb3V0ZVRhYmxlSWRzOiB1bmRlZmluZWQsXG4gICAgICBwcml2YXRlU3VibmV0SWRzOiB1bmRlZmluZWQsXG4gICAgICBwcml2YXRlU3VibmV0TmFtZXM6IHVuZGVmaW5lZCxcbiAgICAgIHByaXZhdGVTdWJuZXRSb3V0ZVRhYmxlSWRzOiB1bmRlZmluZWQsXG4gICAgICBwdWJsaWNTdWJuZXRJZHM6IHVuZGVmaW5lZCxcbiAgICAgIHB1YmxpY1N1Ym5ldE5hbWVzOiB1bmRlZmluZWQsXG4gICAgICBwdWJsaWNTdWJuZXRSb3V0ZVRhYmxlSWRzOiB1bmRlZmluZWQsXG4gICAgICBzdWJuZXRHcm91cHM6IFtcbiAgICAgICAge1xuICAgICAgICAgIG5hbWU6ICdQdWJsaWMnLFxuICAgICAgICAgIHR5cGU6ICdQdWJsaWMnLFxuICAgICAgICAgIHN1Ym5ldHM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgc3VibmV0SWQ6ICdzdWItMTIzNDU2JyxcbiAgICAgICAgICAgICAgYXZhaWxhYmlsaXR5Wm9uZTogJ2Jlcm11ZGEtdHJpYW5nbGUtMTMzNycsXG4gICAgICAgICAgICAgIHJvdXRlVGFibGVJZDogJ3J0Yi0xMjM0NTYnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICBdLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgbmFtZTogJ1ByaXZhdGUnLFxuICAgICAgICAgIHR5cGU6ICdQcml2YXRlJyxcbiAgICAgICAgICBzdWJuZXRzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHN1Ym5ldElkOiAnc3ViLTc4OTAxMicsXG4gICAgICAgICAgICAgIGF2YWlsYWJpbGl0eVpvbmU6ICdiZXJtdWRhLXRyaWFuZ2xlLTEzMzcnLFxuICAgICAgICAgICAgICByb3V0ZVRhYmxlSWQ6ICdydGItNzg5MDEyJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgXSxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgICB2cGNJZDogJ3ZwYy0xMjM0NTY3JyxcbiAgICAgIHZwbkdhdGV3YXlJZDogJ2d3LWFiY2RlZidcbiAgICB9KTtcblxuICAgIEFXUy5yZXN0b3JlKCk7XG4gICAgdGVzdC5kb25lKCk7XG4gIH0sXG5cbiAgYXN5bmMgJ3Rocm93cyB3aGVuIG5vIHN1Y2ggVlBDIGlzIGZvdW5kJyh0ZXN0OiBub2RldW5pdC5UZXN0KSB7XG4gICAgQVdTLm1vY2soJ0VDMicsICdkZXNjcmliZVZwY3MnLCAocGFyYW1zOiBhd3MuRUMyLkRlc2NyaWJlVnBjc1JlcXVlc3QsIGNiOiBBd3NDYWxsYmFjazxhd3MuRUMyLkRlc2NyaWJlVnBjc1Jlc3VsdD4pID0+IHtcbiAgICAgIHRlc3QuZGVlcEVxdWFsKHBhcmFtcy5GaWx0ZXJzLCBbeyBOYW1lOiAnZm9vJywgVmFsdWVzOiBbJ2JhciddIH1dKTtcbiAgICAgIHJldHVybiBjYihudWxsLCB7fSk7XG4gICAgfSk7XG5cbiAgICB0cnkge1xuICAgICAgYXdhaXQgbmV3IFZwY05ldHdvcmtDb250ZXh0UHJvdmlkZXJQbHVnaW4obW9ja1NESykuZ2V0VmFsdWUoe1xuICAgICAgICBmaWx0ZXI6IHsgZm9vOiAnYmFyJyB9LFxuICAgICAgICByZXR1cm5Bc3ltbWV0cmljU3VibmV0czogdHJ1ZSxcbiAgICAgIH0pO1xuXG4gICAgICB0aHJvdyBFcnJvcignVGhlIGV4cGVjdGVkIGV4Y2VwdGlvbiB3YXMgbm90IHJhaXNlZCEnKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICB0ZXN0LnRocm93cygoKSA9PiB7IHRocm93IGU7IH0sIC9Db3VsZCBub3QgZmluZCBhbnkgVlBDcyBtYXRjaGluZy8pO1xuICAgIH1cblxuICAgIEFXUy5yZXN0b3JlKCk7XG4gICAgdGVzdC5kb25lKCk7XG4gIH0sXG5cbiAgYXN5bmMgJ3Rocm93cyB3aGVuIG11bHRpcGxlIFZQQ3MgYXJlIGZvdW5kJyh0ZXN0OiBub2RldW5pdC5UZXN0KSB7XG4gICAgLy8gR0lWRU5cbiAgICBBV1MubW9jaygnRUMyJywgJ2Rlc2NyaWJlVnBjcycsIChwYXJhbXM6IGF3cy5FQzIuRGVzY3JpYmVWcGNzUmVxdWVzdCwgY2I6IEF3c0NhbGxiYWNrPGF3cy5FQzIuRGVzY3JpYmVWcGNzUmVzdWx0PikgPT4ge1xuICAgICAgdGVzdC5kZWVwRXF1YWwocGFyYW1zLkZpbHRlcnMsIFt7IE5hbWU6ICdmb28nLCBWYWx1ZXM6IFsnYmFyJ10gfV0pO1xuICAgICAgcmV0dXJuIGNiKG51bGwsIHsgVnBjczogW3sgVnBjSWQ6ICd2cGMtMScgfSwgeyBWcGNJZDogJ3ZwYy0yJyB9XX0pO1xuICAgIH0pO1xuXG4gICAgLy8gV0hFTlxuICAgIHRyeSB7XG4gICAgICBhd2FpdCBuZXcgVnBjTmV0d29ya0NvbnRleHRQcm92aWRlclBsdWdpbihtb2NrU0RLKS5nZXRWYWx1ZSh7XG4gICAgICAgIGZpbHRlcjogeyBmb286ICdiYXInIH0sXG4gICAgICAgIHJldHVybkFzeW1tZXRyaWNTdWJuZXRzOiB0cnVlLFxuICAgICAgfSk7XG5cbiAgICAgIHRocm93IEVycm9yKCdUaGUgZXhwZWN0ZWQgZXhjZXB0aW9uIHdhcyBub3QgcmFpc2VkIScpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHRlc3QudGhyb3dzKCgpID0+IHsgdGhyb3cgZTsgfSwgL0ZvdW5kIDIgVlBDcyBtYXRjaGluZy8pO1xuICAgIH1cblxuICAgIEFXUy5yZXN0b3JlKCk7XG4gICAgdGVzdC5kb25lKCk7XG4gIH0sXG5cbiAgYXN5bmMgJ3VzZXMgdGhlIFZQQyBtYWluIHJvdXRlIHRhYmxlIHdoZW4gYSBzdWJuZXQgaGFzIG5vIHNwZWNpZmljIGFzc29jaWF0aW9uJyh0ZXN0OiBub2RldW5pdC5UZXN0KSB7XG4gICAgbW9ja1ZwY0xvb2t1cCh0ZXN0LCB7XG4gICAgICBzdWJuZXRzOiBbXG4gICAgICAgIHsgU3VibmV0SWQ6ICdzdWItMTIzNDU2JywgQXZhaWxhYmlsaXR5Wm9uZTogJ2Jlcm11ZGEtdHJpYW5nbGUtMTMzNycsIE1hcFB1YmxpY0lwT25MYXVuY2g6IHRydWUgfSxcbiAgICAgICAgeyBTdWJuZXRJZDogJ3N1Yi03ODkwMTInLCBBdmFpbGFiaWxpdHlab25lOiAnYmVybXVkYS10cmlhbmdsZS0xMzM3JywgTWFwUHVibGljSXBPbkxhdW5jaDogZmFsc2UgfVxuICAgICAgXSxcbiAgICAgIHJvdXRlVGFibGVzOiBbXG4gICAgICAgIHsgQXNzb2NpYXRpb25zOiBbeyBTdWJuZXRJZDogJ3N1Yi0xMjM0NTYnIH1dLCBSb3V0ZVRhYmxlSWQ6ICdydGItMTIzNDU2JywgfSxcbiAgICAgICAgeyBBc3NvY2lhdGlvbnM6IFt7IE1haW46IHRydWUgfV0sIFJvdXRlVGFibGVJZDogJ3J0Yi03ODkwMTInLCB9XG4gICAgICBdLFxuICAgICAgdnBuR2F0ZXdheXM6IFt7IFZwbkdhdGV3YXlJZDogJ2d3LWFiY2RlZicgfV1cbiAgICB9KTtcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG5ldyBWcGNOZXR3b3JrQ29udGV4dFByb3ZpZGVyUGx1Z2luKG1vY2tTREspLmdldFZhbHVlKHtcbiAgICAgIGZpbHRlcjogeyBmb286ICdiYXInIH0sXG4gICAgICByZXR1cm5Bc3ltbWV0cmljU3VibmV0czogdHJ1ZSxcbiAgICB9KTtcblxuICAgIHRlc3QuZGVlcEVxdWFsKHJlc3VsdCwge1xuICAgICAgYXZhaWxhYmlsaXR5Wm9uZXM6IFtdLFxuICAgICAgaXNvbGF0ZWRTdWJuZXRJZHM6IHVuZGVmaW5lZCxcbiAgICAgIGlzb2xhdGVkU3VibmV0TmFtZXM6IHVuZGVmaW5lZCxcbiAgICAgIGlzb2xhdGVkU3VibmV0Um91dGVUYWJsZUlkczogdW5kZWZpbmVkLFxuICAgICAgcHJpdmF0ZVN1Ym5ldElkczogdW5kZWZpbmVkLFxuICAgICAgcHJpdmF0ZVN1Ym5ldE5hbWVzOiB1bmRlZmluZWQsXG4gICAgICBwcml2YXRlU3VibmV0Um91dGVUYWJsZUlkczogdW5kZWZpbmVkLFxuICAgICAgcHVibGljU3VibmV0SWRzOiB1bmRlZmluZWQsXG4gICAgICBwdWJsaWNTdWJuZXROYW1lczogdW5kZWZpbmVkLFxuICAgICAgcHVibGljU3VibmV0Um91dGVUYWJsZUlkczogdW5kZWZpbmVkLFxuICAgICAgc3VibmV0R3JvdXBzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBuYW1lOiAnUHVibGljJyxcbiAgICAgICAgICB0eXBlOiAnUHVibGljJyxcbiAgICAgICAgICBzdWJuZXRzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHN1Ym5ldElkOiAnc3ViLTEyMzQ1NicsXG4gICAgICAgICAgICAgIGF2YWlsYWJpbGl0eVpvbmU6ICdiZXJtdWRhLXRyaWFuZ2xlLTEzMzcnLFxuICAgICAgICAgICAgICByb3V0ZVRhYmxlSWQ6ICdydGItMTIzNDU2JyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgXSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIG5hbWU6ICdQcml2YXRlJyxcbiAgICAgICAgICB0eXBlOiAnUHJpdmF0ZScsXG4gICAgICAgICAgc3VibmV0czogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBzdWJuZXRJZDogJ3N1Yi03ODkwMTInLFxuICAgICAgICAgICAgICBhdmFpbGFiaWxpdHlab25lOiAnYmVybXVkYS10cmlhbmdsZS0xMzM3JyxcbiAgICAgICAgICAgICAgcm91dGVUYWJsZUlkOiAncnRiLTc4OTAxMicsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIF0sXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgICAgdnBjSWQ6ICd2cGMtMTIzNDU2NycsXG4gICAgICB2cG5HYXRld2F5SWQ6ICdndy1hYmNkZWYnXG4gICAgfSk7XG5cbiAgICB0ZXN0LmRvbmUoKTtcbiAgICBBV1MucmVzdG9yZSgpO1xuICB9LFxuXG4gIGFzeW5jICdSZWNvZ25pemUgcHVibGljIHN1Ym5ldCBieSByb3V0ZSB0YWJsZScodGVzdDogbm9kZXVuaXQuVGVzdCkge1xuICAgIC8vIEdJVkVOXG4gICAgbW9ja1ZwY0xvb2t1cCh0ZXN0LCB7XG4gICAgICBzdWJuZXRzOiBbXG4gICAgICAgIHsgU3VibmV0SWQ6ICdzdWItMTIzNDU2JywgQXZhaWxhYmlsaXR5Wm9uZTogJ2Jlcm11ZGEtdHJpYW5nbGUtMTMzNycsIE1hcFB1YmxpY0lwT25MYXVuY2g6IGZhbHNlIH0sXG4gICAgICBdLFxuICAgICAgcm91dGVUYWJsZXM6IFtcbiAgICAgICAge1xuICAgICAgICAgIEFzc29jaWF0aW9uczogW3sgU3VibmV0SWQ6ICdzdWItMTIzNDU2JyB9XSxcbiAgICAgICAgICBSb3V0ZVRhYmxlSWQ6ICdydGItMTIzNDU2JyxcbiAgICAgICAgICBSb3V0ZXM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgRGVzdGluYXRpb25DaWRyQmxvY2s6IFwiMTAuMC4yLjAvMjZcIixcbiAgICAgICAgICAgICAgT3JpZ2luOiBcIkNyZWF0ZVJvdXRlXCIsXG4gICAgICAgICAgICAgIFN0YXRlOiBcImFjdGl2ZVwiLFxuICAgICAgICAgICAgICBWcGNQZWVyaW5nQ29ubmVjdGlvbklkOiBcInBjeC14eHh4eHhcIlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgRGVzdGluYXRpb25DaWRyQmxvY2s6IFwiMTAuMC4xLjAvMjRcIixcbiAgICAgICAgICAgICAgR2F0ZXdheUlkOiBcImxvY2FsXCIsXG4gICAgICAgICAgICAgIE9yaWdpbjogXCJDcmVhdGVSb3V0ZVRhYmxlXCIsXG4gICAgICAgICAgICAgIFN0YXRlOiBcImFjdGl2ZVwiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBEZXN0aW5hdGlvbkNpZHJCbG9jazogXCIwLjAuMC4wLzBcIixcbiAgICAgICAgICAgICAgR2F0ZXdheUlkOiBcImlndy14eHh4eHhcIixcbiAgICAgICAgICAgICAgT3JpZ2luOiBcIkNyZWF0ZVJvdXRlXCIsXG4gICAgICAgICAgICAgIFN0YXRlOiBcImFjdGl2ZVwiXG4gICAgICAgICAgICB9XG4gICAgICAgICAgXSxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSk7XG5cbiAgICAvLyBXSEVOXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbmV3IFZwY05ldHdvcmtDb250ZXh0UHJvdmlkZXJQbHVnaW4obW9ja1NESykuZ2V0VmFsdWUoe1xuICAgICAgZmlsdGVyOiB7IGZvbzogJ2JhcicgfSxcbiAgICAgIHJldHVybkFzeW1tZXRyaWNTdWJuZXRzOiB0cnVlLFxuICAgIH0pO1xuXG4gICAgLy8gVEhFTlxuICAgIHRlc3QuZGVlcEVxdWFsKHJlc3VsdCwge1xuICAgICAgYXZhaWxhYmlsaXR5Wm9uZXM6IFtdLFxuICAgICAgaXNvbGF0ZWRTdWJuZXRJZHM6IHVuZGVmaW5lZCxcbiAgICAgIGlzb2xhdGVkU3VibmV0TmFtZXM6IHVuZGVmaW5lZCxcbiAgICAgIGlzb2xhdGVkU3VibmV0Um91dGVUYWJsZUlkczogdW5kZWZpbmVkLFxuICAgICAgcHJpdmF0ZVN1Ym5ldElkczogdW5kZWZpbmVkLFxuICAgICAgcHJpdmF0ZVN1Ym5ldE5hbWVzOiB1bmRlZmluZWQsXG4gICAgICBwcml2YXRlU3VibmV0Um91dGVUYWJsZUlkczogdW5kZWZpbmVkLFxuICAgICAgcHVibGljU3VibmV0SWRzOiB1bmRlZmluZWQsXG4gICAgICBwdWJsaWNTdWJuZXROYW1lczogdW5kZWZpbmVkLFxuICAgICAgcHVibGljU3VibmV0Um91dGVUYWJsZUlkczogdW5kZWZpbmVkLFxuICAgICAgc3VibmV0R3JvdXBzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBuYW1lOiAnUHVibGljJyxcbiAgICAgICAgICB0eXBlOiAnUHVibGljJyxcbiAgICAgICAgICBzdWJuZXRzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHN1Ym5ldElkOiAnc3ViLTEyMzQ1NicsXG4gICAgICAgICAgICAgIGF2YWlsYWJpbGl0eVpvbmU6ICdiZXJtdWRhLXRyaWFuZ2xlLTEzMzcnLFxuICAgICAgICAgICAgICByb3V0ZVRhYmxlSWQ6ICdydGItMTIzNDU2JyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgXSxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgICB2cGNJZDogJ3ZwYy0xMjM0NTY3JyxcbiAgICAgIHZwbkdhdGV3YXlJZDogdW5kZWZpbmVkLFxuICAgIH0pO1xuXG4gICAgQVdTLnJlc3RvcmUoKTtcbiAgICB0ZXN0LmRvbmUoKTtcbiAgfSxcblxuICBhc3luYyAnd29ya3MgZm9yIGFzeW1tZXRyaWMgc3VibmV0cyAobm90IHNwYW5uaW5nIHRoZSBzYW1lIEF2YWlsYWJpbGl0eSBab25lcyknKHRlc3Q6IG5vZGV1bml0LlRlc3QpIHtcbiAgICAvLyBHSVZFTlxuICAgIG1vY2tWcGNMb29rdXAodGVzdCwge1xuICAgICAgc3VibmV0czogW1xuICAgICAgICB7IFN1Ym5ldElkOiAncHJpLXN1Yi1pbi0xYicsIEF2YWlsYWJpbGl0eVpvbmU6ICd1cy13ZXN0LTFiJywgTWFwUHVibGljSXBPbkxhdW5jaDogZmFsc2UgfSxcbiAgICAgICAgeyBTdWJuZXRJZDogJ3B1Yi1zdWItaW4tMWMnLCBBdmFpbGFiaWxpdHlab25lOiAndXMtd2VzdC0xYycsIE1hcFB1YmxpY0lwT25MYXVuY2g6IHRydWUgIH0sXG4gICAgICAgIHsgU3VibmV0SWQ6ICdwdWItc3ViLWluLTFiJywgQXZhaWxhYmlsaXR5Wm9uZTogJ3VzLXdlc3QtMWInLCBNYXBQdWJsaWNJcE9uTGF1bmNoOiB0cnVlICB9LFxuICAgICAgICB7IFN1Ym5ldElkOiAncHViLXN1Yi1pbi0xYScsIEF2YWlsYWJpbGl0eVpvbmU6ICd1cy13ZXN0LTFhJywgTWFwUHVibGljSXBPbkxhdW5jaDogdHJ1ZSAgfSxcbiAgICAgIF0sXG4gICAgICByb3V0ZVRhYmxlczogW1xuICAgICAgICB7IEFzc29jaWF0aW9uczogW3sgTWFpbjogdHJ1ZSB9XSwgUm91dGVUYWJsZUlkOiAncnRiLTEyMycgfSxcbiAgICAgIF0sXG4gICAgfSk7XG5cbiAgICAvLyBXSEVOXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbmV3IFZwY05ldHdvcmtDb250ZXh0UHJvdmlkZXJQbHVnaW4obW9ja1NESykuZ2V0VmFsdWUoe1xuICAgICAgZmlsdGVyOiB7IGZvbzogJ2JhcicgfSxcbiAgICAgIHJldHVybkFzeW1tZXRyaWNTdWJuZXRzOiB0cnVlLFxuICAgIH0pO1xuXG4gICAgLy8gVEhFTlxuICAgIHRlc3QuZGVlcEVxdWFsKHJlc3VsdCwge1xuICAgICAgYXZhaWxhYmlsaXR5Wm9uZXM6IFtdLFxuICAgICAgaXNvbGF0ZWRTdWJuZXRJZHM6IHVuZGVmaW5lZCxcbiAgICAgIGlzb2xhdGVkU3VibmV0TmFtZXM6IHVuZGVmaW5lZCxcbiAgICAgIGlzb2xhdGVkU3VibmV0Um91dGVUYWJsZUlkczogdW5kZWZpbmVkLFxuICAgICAgcHJpdmF0ZVN1Ym5ldElkczogdW5kZWZpbmVkLFxuICAgICAgcHJpdmF0ZVN1Ym5ldE5hbWVzOiB1bmRlZmluZWQsXG4gICAgICBwcml2YXRlU3VibmV0Um91dGVUYWJsZUlkczogdW5kZWZpbmVkLFxuICAgICAgcHVibGljU3VibmV0SWRzOiB1bmRlZmluZWQsXG4gICAgICBwdWJsaWNTdWJuZXROYW1lczogdW5kZWZpbmVkLFxuICAgICAgcHVibGljU3VibmV0Um91dGVUYWJsZUlkczogdW5kZWZpbmVkLFxuICAgICAgc3VibmV0R3JvdXBzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBuYW1lOiAnUHJpdmF0ZScsXG4gICAgICAgICAgdHlwZTogJ1ByaXZhdGUnLFxuICAgICAgICAgIHN1Ym5ldHM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgc3VibmV0SWQ6ICdwcmktc3ViLWluLTFiJyxcbiAgICAgICAgICAgICAgYXZhaWxhYmlsaXR5Wm9uZTogJ3VzLXdlc3QtMWInLFxuICAgICAgICAgICAgICByb3V0ZVRhYmxlSWQ6ICdydGItMTIzJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgXSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIG5hbWU6ICdQdWJsaWMnLFxuICAgICAgICAgIHR5cGU6ICdQdWJsaWMnLFxuICAgICAgICAgIHN1Ym5ldHM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgc3VibmV0SWQ6ICdwdWItc3ViLWluLTFhJyxcbiAgICAgICAgICAgICAgYXZhaWxhYmlsaXR5Wm9uZTogJ3VzLXdlc3QtMWEnLFxuICAgICAgICAgICAgICByb3V0ZVRhYmxlSWQ6ICdydGItMTIzJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHN1Ym5ldElkOiAncHViLXN1Yi1pbi0xYicsXG4gICAgICAgICAgICAgIGF2YWlsYWJpbGl0eVpvbmU6ICd1cy13ZXN0LTFiJyxcbiAgICAgICAgICAgICAgcm91dGVUYWJsZUlkOiAncnRiLTEyMycsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBzdWJuZXRJZDogJ3B1Yi1zdWItaW4tMWMnLFxuICAgICAgICAgICAgICBhdmFpbGFiaWxpdHlab25lOiAndXMtd2VzdC0xYycsXG4gICAgICAgICAgICAgIHJvdXRlVGFibGVJZDogJ3J0Yi0xMjMnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICBdLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICAgIHZwY0lkOiAndnBjLTEyMzQ1NjcnLFxuICAgICAgdnBuR2F0ZXdheUlkOiB1bmRlZmluZWQsXG4gICAgfSk7XG5cbiAgICBBV1MucmVzdG9yZSgpO1xuICAgIHRlc3QuZG9uZSgpO1xuICB9LFxuXG4gIGFzeW5jICdhbGxvd3Mgc3BlY2lmeWluZyB0aGUgc3VibmV0IGdyb3VwIG5hbWUgdGFnJyh0ZXN0OiBub2RldW5pdC5UZXN0KSB7XG4gICAgLy8gR0lWRU5cbiAgICBtb2NrVnBjTG9va3VwKHRlc3QsIHtcbiAgICAgIHN1Ym5ldHM6IFtcbiAgICAgICAge1xuICAgICAgICAgIFN1Ym5ldElkOiAncHJpLXN1Yi1pbi0xYicsIEF2YWlsYWJpbGl0eVpvbmU6ICd1cy13ZXN0LTFiJywgTWFwUHVibGljSXBPbkxhdW5jaDogZmFsc2UsIFRhZ3M6IFtcbiAgICAgICAgICAgIHsgS2V5OiAnVGllcicsIFZhbHVlOiAncmVzdHJpY3RlZCcgfSxcbiAgICAgICAgXSB9LFxuICAgICAgICB7XG4gICAgICAgICAgU3VibmV0SWQ6ICdwdWItc3ViLWluLTFjJywgQXZhaWxhYmlsaXR5Wm9uZTogJ3VzLXdlc3QtMWMnLCBNYXBQdWJsaWNJcE9uTGF1bmNoOiB0cnVlLCBUYWdzOiBbXG4gICAgICAgICAgICB7IEtleTogJ1RpZXInLCBWYWx1ZTogJ2Nvbm5lY3Rpdml0eScgfSxcbiAgICAgICAgXSB9LFxuICAgICAgICB7XG4gICAgICAgICAgU3VibmV0SWQ6ICdwdWItc3ViLWluLTFiJywgQXZhaWxhYmlsaXR5Wm9uZTogJ3VzLXdlc3QtMWInLCBNYXBQdWJsaWNJcE9uTGF1bmNoOiB0cnVlLCBUYWdzOiBbXG4gICAgICAgICAgICB7IEtleTogJ1RpZXInLCBWYWx1ZTogJ2Nvbm5lY3Rpdml0eScgfSxcbiAgICAgICAgXSB9LFxuICAgICAgICB7XG4gICAgICAgICAgU3VibmV0SWQ6ICdwdWItc3ViLWluLTFhJywgQXZhaWxhYmlsaXR5Wm9uZTogJ3VzLXdlc3QtMWEnLCBNYXBQdWJsaWNJcE9uTGF1bmNoOiB0cnVlLCBUYWdzOiBbXG4gICAgICAgICAgICB7IEtleTogJ1RpZXInLCBWYWx1ZTogJ2Nvbm5lY3Rpdml0eScgfSxcbiAgICAgICAgXSB9LFxuICAgICAgXSxcbiAgICAgIHJvdXRlVGFibGVzOiBbXG4gICAgICAgIHsgQXNzb2NpYXRpb25zOiBbeyBNYWluOiB0cnVlIH1dLCBSb3V0ZVRhYmxlSWQ6ICdydGItMTIzJyB9LFxuICAgICAgXSxcbiAgICB9KTtcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG5ldyBWcGNOZXR3b3JrQ29udGV4dFByb3ZpZGVyUGx1Z2luKG1vY2tTREspLmdldFZhbHVlKHtcbiAgICAgIGZpbHRlcjogeyBmb286ICdiYXInIH0sXG4gICAgICByZXR1cm5Bc3ltbWV0cmljU3VibmV0czogdHJ1ZSxcbiAgICAgIHN1Ym5ldEdyb3VwTmFtZVRhZzogJ1RpZXInLFxuICAgIH0pO1xuXG4gICAgdGVzdC5kZWVwRXF1YWwocmVzdWx0LCB7XG4gICAgICBhdmFpbGFiaWxpdHlab25lczogW10sXG4gICAgICBpc29sYXRlZFN1Ym5ldElkczogdW5kZWZpbmVkLFxuICAgICAgaXNvbGF0ZWRTdWJuZXROYW1lczogdW5kZWZpbmVkLFxuICAgICAgaXNvbGF0ZWRTdWJuZXRSb3V0ZVRhYmxlSWRzOiB1bmRlZmluZWQsXG4gICAgICBwcml2YXRlU3VibmV0SWRzOiB1bmRlZmluZWQsXG4gICAgICBwcml2YXRlU3VibmV0TmFtZXM6IHVuZGVmaW5lZCxcbiAgICAgIHByaXZhdGVTdWJuZXRSb3V0ZVRhYmxlSWRzOiB1bmRlZmluZWQsXG4gICAgICBwdWJsaWNTdWJuZXRJZHM6IHVuZGVmaW5lZCxcbiAgICAgIHB1YmxpY1N1Ym5ldE5hbWVzOiB1bmRlZmluZWQsXG4gICAgICBwdWJsaWNTdWJuZXRSb3V0ZVRhYmxlSWRzOiB1bmRlZmluZWQsXG4gICAgICBzdWJuZXRHcm91cHM6IFtcbiAgICAgICAge1xuICAgICAgICAgIG5hbWU6ICdyZXN0cmljdGVkJyxcbiAgICAgICAgICB0eXBlOiAnUHJpdmF0ZScsXG4gICAgICAgICAgc3VibmV0czogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBzdWJuZXRJZDogJ3ByaS1zdWItaW4tMWInLFxuICAgICAgICAgICAgICBhdmFpbGFiaWxpdHlab25lOiAndXMtd2VzdC0xYicsXG4gICAgICAgICAgICAgIHJvdXRlVGFibGVJZDogJ3J0Yi0xMjMnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICBdLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgbmFtZTogJ2Nvbm5lY3Rpdml0eScsXG4gICAgICAgICAgdHlwZTogJ1B1YmxpYycsXG4gICAgICAgICAgc3VibmV0czogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBzdWJuZXRJZDogJ3B1Yi1zdWItaW4tMWEnLFxuICAgICAgICAgICAgICBhdmFpbGFiaWxpdHlab25lOiAndXMtd2VzdC0xYScsXG4gICAgICAgICAgICAgIHJvdXRlVGFibGVJZDogJ3J0Yi0xMjMnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgc3VibmV0SWQ6ICdwdWItc3ViLWluLTFiJyxcbiAgICAgICAgICAgICAgYXZhaWxhYmlsaXR5Wm9uZTogJ3VzLXdlc3QtMWInLFxuICAgICAgICAgICAgICByb3V0ZVRhYmxlSWQ6ICdydGItMTIzJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHN1Ym5ldElkOiAncHViLXN1Yi1pbi0xYycsXG4gICAgICAgICAgICAgIGF2YWlsYWJpbGl0eVpvbmU6ICd1cy13ZXN0LTFjJyxcbiAgICAgICAgICAgICAgcm91dGVUYWJsZUlkOiAncnRiLTEyMycsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIF0sXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgICAgdnBjSWQ6ICd2cGMtMTIzNDU2NycsXG4gICAgICB2cG5HYXRld2F5SWQ6IHVuZGVmaW5lZCxcbiAgICB9KTtcblxuICAgIEFXUy5yZXN0b3JlKCk7XG4gICAgdGVzdC5kb25lKCk7XG4gIH0sXG59KTtcblxuaW50ZXJmYWNlIFZwY0xvb2t1cE9wdGlvbnMge1xuICBzdWJuZXRzOiBhd3MuRUMyLlN1Ym5ldFtdO1xuICByb3V0ZVRhYmxlczogYXdzLkVDMi5Sb3V0ZVRhYmxlW107XG4gIHZwbkdhdGV3YXlzPzogYXdzLkVDMi5WcG5HYXRld2F5W107XG59XG5cbmZ1bmN0aW9uIG1vY2tWcGNMb29rdXAodGVzdDogbm9kZXVuaXQuVGVzdCwgb3B0aW9uczogVnBjTG9va3VwT3B0aW9ucykge1xuICBjb25zdCBWcGNJZCA9ICd2cGMtMTIzNDU2Nyc7XG5cbiAgQVdTLm1vY2soJ0VDMicsICdkZXNjcmliZVZwY3MnLCAocGFyYW1zOiBhd3MuRUMyLkRlc2NyaWJlVnBjc1JlcXVlc3QsIGNiOiBBd3NDYWxsYmFjazxhd3MuRUMyLkRlc2NyaWJlVnBjc1Jlc3VsdD4pID0+IHtcbiAgICB0ZXN0LmRlZXBFcXVhbChwYXJhbXMuRmlsdGVycywgW3sgTmFtZTogJ2ZvbycsIFZhbHVlczogWydiYXInXSB9XSk7XG4gICAgcmV0dXJuIGNiKG51bGwsIHsgVnBjczogW3sgVnBjSWQgfV0gfSk7XG4gIH0pO1xuXG4gIEFXUy5tb2NrKCdFQzInLCAnZGVzY3JpYmVTdWJuZXRzJywgKHBhcmFtczogYXdzLkVDMi5EZXNjcmliZVN1Ym5ldHNSZXF1ZXN0LCBjYjogQXdzQ2FsbGJhY2s8YXdzLkVDMi5EZXNjcmliZVN1Ym5ldHNSZXN1bHQ+KSA9PiB7XG4gICAgdGVzdC5kZWVwRXF1YWwocGFyYW1zLkZpbHRlcnMsIFt7IE5hbWU6ICd2cGMtaWQnLCBWYWx1ZXM6IFtWcGNJZF0gfV0pO1xuICAgIHJldHVybiBjYihudWxsLCB7IFN1Ym5ldHM6IG9wdGlvbnMuc3VibmV0cyB9KTtcbiAgfSk7XG5cbiAgQVdTLm1vY2soJ0VDMicsICdkZXNjcmliZVJvdXRlVGFibGVzJywgKHBhcmFtczogYXdzLkVDMi5EZXNjcmliZVJvdXRlVGFibGVzUmVxdWVzdCwgY2I6IEF3c0NhbGxiYWNrPGF3cy5FQzIuRGVzY3JpYmVSb3V0ZVRhYmxlc1Jlc3VsdD4pID0+IHtcbiAgICB0ZXN0LmRlZXBFcXVhbChwYXJhbXMuRmlsdGVycywgW3sgTmFtZTogJ3ZwYy1pZCcsIFZhbHVlczogW1ZwY0lkXSB9XSk7XG4gICAgcmV0dXJuIGNiKG51bGwsIHsgUm91dGVUYWJsZXM6IG9wdGlvbnMucm91dGVUYWJsZXMgfSk7XG4gIH0pO1xuXG4gIEFXUy5tb2NrKCdFQzInLCAnZGVzY3JpYmVWcG5HYXRld2F5cycsIChwYXJhbXM6IGF3cy5FQzIuRGVzY3JpYmVWcG5HYXRld2F5c1JlcXVlc3QsIGNiOiBBd3NDYWxsYmFjazxhd3MuRUMyLkRlc2NyaWJlVnBuR2F0ZXdheXNSZXN1bHQ+KSA9PiB7XG4gICAgdGVzdC5kZWVwRXF1YWwocGFyYW1zLkZpbHRlcnMsIFtcbiAgICAgIHsgTmFtZTogJ2F0dGFjaG1lbnQudnBjLWlkJywgVmFsdWVzOiBbIFZwY0lkIF0gfSxcbiAgICAgIHsgTmFtZTogJ2F0dGFjaG1lbnQuc3RhdGUnLCBWYWx1ZXM6IFsgJ2F0dGFjaGVkJyBdIH0sXG4gICAgICB7IE5hbWU6ICdzdGF0ZScsIFZhbHVlczogWyAnYXZhaWxhYmxlJyBdIH1cbiAgICBdKTtcbiAgICByZXR1cm4gY2IobnVsbCwgeyBWcG5HYXRld2F5czogb3B0aW9ucy52cG5HYXRld2F5cyB9KTtcbiAgfSk7XG59XG4iXX0=